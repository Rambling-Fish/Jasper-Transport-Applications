<head>
<script type="text/javascript" src="mule-resource/js/mule.js"></script>
<script type="text/javascript">

	function load() {
    	mule.subscribe("/webview/svgtrax", handleSvgTrax);  
    }
    
    function handleSvgTrax(message) {
		var targets = dojo.fromJson(message.data);
        if (message) {
            var tg = document.getElementById("targetGroup")
            
            while (tg.firstChild) {
                tg.removeChild(tg.firstChild);
            }  

			for (var i = 0; i < targets.length; i++) {
			    var circ = document.createElementNS("http://www.w3.org/2000/svg", "circle");
			    
			    if(targets[i].target_type == "aircraft"){
					circ.setAttribute('class', 'styleAircraft');
			    }else if(targets[i].target_type == "vehicle"){
					circ.setAttribute('class', 'styleVehicle');
			    }else{
					circ.setAttribute('class', 'styleOther');
			    }
				circ.setAttribute('cx', targets[i].x);
				circ.setAttribute('cy', targets[i].y);
				circ.setAttribute('r', '5');				
				
	            var text = document.createElementNS("http://www.w3.org/2000/svg", "text");
	           	text.setAttribute('class', 'labels');
		        text.setAttribute('x', targets[i].textX);
		        text.setAttribute('y', targets[i].textY);
		        var textNode = document.createTextNode(targets[i].trackId);
		        text.appendChild(textNode);

		        tg.appendChild(circ);
	            tg.appendChild(text);
			}
        }  
    }

</script>
</head>
<body onload="load()">
<svg xmlns="http://www.w3.org/2000/svg" width="800" height="800" version="1.0"> 

  <defs id="shapes_and_styles">
    <style type="text/css"><![CDATA[
      .styleLine { stroke:#000000; stroke-width:1;stroke-opacity:0.5; }
      .styleAircraft { fill:blue; fill-opacity:0.5; stroke:#000000; stroke-width:1.0; }
      .styleVehicle { fill:red; fill-opacity:0.5; stroke:#000000; stroke-width:1.0; }
      .styleOther { fill:green; fill-opacity:0.5; stroke:#000000; stroke-width:1.0; }
      .labels {font-size:10px; font-style:normal; font-family:Bitstream Vera Sans
    ]]></style>
  </defs>
  
  <image x="0" y="0" width="800" height="800" xlink:href="background.png"/>
  <image x="0" y="0" width="800" height="800" xlink:href="yow.png"/>
  <rect  width="800" height="800" style="fill:nofill;stroke:navy;stroke-width:5;fill-opacity:0.0;stroke-opacity:0.9"/>
  <line class="styleLine" x1="400" y1="0" x2="400" y2="800"/>
  <line class="styleLine" x1="0" y1="400" x2="800" y2="400"/>
 
  <g id="targetGroup"/>
  

</svg>
</body>
</html>
